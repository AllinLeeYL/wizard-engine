// Copyright 2023 Wizard authors. All rights reserved.
// See LICENSE for details of Apache 2.0 license.


def T = UnitTests.registerT("wasi:", _, WasiTester.new, _);
def X = [
	T("normalize_path0", test_normalize_path0),
	T("normalize_path1", test_normalize_path1)
];

class WasiTester(t: Tester) {
  var assertStrEq = t.assert_string;
}

def test_normalize_path0(t: WasiTester){
  
  var test0 = WasiPathUtil.normalize_path("", 0).0;
  var test0Res = ".";
  t.assertStrEq(test0Res, test0);
  
  var test1 = WasiPathUtil.normalize_path("./", 2).0;
  var test1Res = ".";
  t.assertStrEq(test1Res, test1);

  var test2 = WasiPathUtil.normalize_path("./abc/", 6).0;
  var test2Res = "abc";
  t.assertStrEq(test2Res, test2);

  

}

def test_normalize_path1(t: WasiTester){

  var test0 = WasiPathUtil.normalize_path("././", 4).0;
  var test0Res = ".";
  t.assertStrEq(test0Res, test0);

  var test1 = WasiPathUtil.normalize_path("./abc/sa", 8).0;
  var test1Res = "abc/sa";
  t.assertStrEq(test1Res, test1);

  var test2 = WasiPathUtil.normalize_path("./abc/../aaa/ac", 15).0;
  var test2Res = "aaa/ac";
  
  t.assertStrEq(test2Res, test2);

}


